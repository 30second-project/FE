{"ast":null,"code":"import { useEffect } from \"react\";\nimport { logger } from \"@rpldy/shared\";\nimport { useUploadyContext } from \"@rpldy/shared-ui\";\nconst getUrl = form => {\n  const loc = window.location;\n  let url = form.getAttribute(\"action\") || \"\";\n  url = url.replace(/\\s/g, \"\");\n  let path;\n  switch (true) {\n    case url === \"\":\n      url = loc.href;\n      break;\n    case url.startsWith(\"/\"):\n      url = `${loc.protocol}//${loc.host}${url}`;\n      break;\n    case !/:\\/\\//.test(url):\n      path = loc.pathname.split(\"/\").slice(0, -1).concat(\"\").join(\"/\");\n      url = `${loc.protocol}//${loc.host}${path}${url}`;\n      break;\n  }\n  return url;\n};\nconst getDestinationFromInput = input => {\n  const form = input.closest(\"form\");\n  let destination = {\n    filesParamName: input.getAttribute(\"name\"),\n    method: undefined,\n    url: undefined\n  };\n  if (form) {\n    const method = form.getAttribute(\"method\"),\n      url = getUrl(form);\n    destination.method = method ? method.toUpperCase() : undefined;\n    destination.url = url;\n    logger.debugLog(`Uploady.useFileInput: using custom input's parent form url ${destination.url} and method ${destination.method || \"\"}`);\n  }\n  return destination;\n};\nconst useFileInput = fileInputRef => {\n  const context = useUploadyContext();\n  if (fileInputRef) {\n    context.setExternalFileInput(fileInputRef);\n  }\n  useEffect(() => {\n    if (fileInputRef?.current && \"closest\" in fileInputRef.current) {\n      const input = fileInputRef.current;\n      const uploaderOptions = context.getOptions();\n      if (!uploaderOptions.destination || !uploaderOptions.destination.url) {\n        const domDestination = getDestinationFromInput(input);\n        context.setOptions({\n          destination: domDestination\n        });\n      }\n    }\n  }, [fileInputRef, context]);\n  return !!fileInputRef ? fileInputRef : context.getInternalFileInput();\n};\nexport default useFileInput;","map":{"version":3,"names":["useEffect","logger","useUploadyContext","getUrl","form","loc","window","location","url","getAttribute","replace","path","href","startsWith","protocol","host","test","pathname","split","slice","concat","join","getDestinationFromInput","input","closest","destination","filesParamName","method","undefined","toUpperCase","debugLog","useFileInput","fileInputRef","context","setExternalFileInput","current","uploaderOptions","getOptions","domDestination","setOptions","getInternalFileInput"],"sources":["C:/Users/y2006/OneDrive/바탕 화면/poba/poba/node_modules/@rpldy/uploady/lib/esm/useFileInput.js"],"sourcesContent":["import { useEffect } from \"react\";\nimport { logger } from \"@rpldy/shared\";\nimport { useUploadyContext } from \"@rpldy/shared-ui\";\nconst getUrl = form => {\n  const loc = window.location;\n  let url = form.getAttribute(\"action\") || \"\";\n  url = url.replace(/\\s/g, \"\");\n  let path;\n  switch (true) {\n    case url === \"\":\n      url = loc.href;\n      break;\n    case url.startsWith(\"/\"):\n      url = `${loc.protocol}//${loc.host}${url}`;\n      break;\n    case !/:\\/\\//.test(url):\n      path = loc.pathname.split(\"/\").slice(0, -1).concat(\"\").join(\"/\");\n      url = `${loc.protocol}//${loc.host}${path}${url}`;\n      break;\n  }\n  return url;\n};\nconst getDestinationFromInput = input => {\n  const form = input.closest(\"form\");\n  let destination = {\n    filesParamName: input.getAttribute(\"name\"),\n    method: undefined,\n    url: undefined\n  };\n  if (form) {\n    const method = form.getAttribute(\"method\"),\n      url = getUrl(form);\n    destination.method = method ? method.toUpperCase() : undefined;\n    destination.url = url;\n    logger.debugLog(`Uploady.useFileInput: using custom input's parent form url ${destination.url} and method ${destination.method || \"\"}`);\n  }\n  return destination;\n};\nconst useFileInput = fileInputRef => {\n  const context = useUploadyContext();\n  if (fileInputRef) {\n    context.setExternalFileInput(fileInputRef);\n  }\n  useEffect(() => {\n    if (fileInputRef?.current && \"closest\" in fileInputRef.current) {\n      const input = fileInputRef.current;\n      const uploaderOptions = context.getOptions();\n      if (!uploaderOptions.destination || !uploaderOptions.destination.url) {\n        const domDestination = getDestinationFromInput(input);\n        context.setOptions({\n          destination: domDestination\n        });\n      }\n    }\n  }, [fileInputRef, context]);\n  return !!fileInputRef ? fileInputRef : context.getInternalFileInput();\n};\nexport default useFileInput;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}